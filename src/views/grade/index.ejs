<!DOCTYPE html>
<html lang="pt-br">
<%- include('../partials/header.ejs')%>

    <body class="container-fluid">

        <div class="row d-flex">
            <%- include('../partials/nav.ejs')%>

                <div class="col-11 container-conteudo">
                    <div class="container-conteudo">
                        <div class="row grade-top d-flex justify-content-between">
                            <div class="titulo d-flex justify-content-start col-8">
                                <h2>Grade de Horários</h2>
                            </div>
                            <div class="row predios mt-5 col-4">
                                <select id="selectPredio" class="form-select">
                                    <% predios.forEach(element=> { %>
                                        <option value="<%= element.id %>">
                                            <%= element.nome %>
                                        </option>
                                        <% }) %>
                                </select>
                                <select id="selectSala" class="form-select">
                                    <% var i=0 %>
                                    <% predios[i].salas.forEach(element=> { %>
                                        <option value="<%= element.id %>">
                                            <%= element.nome %>
                                        </option>
                                    <% }) %>
                                </select>
                            </div>
                        </div>
                        <%- include('./gradeHorarios.ejs') %>
                    </div>
                </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>

        <script>
            // Inicializa os popovers
            var popovers = new bootstrap.Popover(document.body, {
                selector: '[data-bs-toggle="popover"]',
                container: 'body',
                trigger: 'hover'
            });
        </script>

        <script>
            // ATUALIZA SALAS
            var predios = JSON.parse('<%- JSON.stringify(predios) %>');
            var salaId = function (){
                document.getElementById('selectSalas').addEventListener('change',function(){
                    return this.value;
                })
            }

            document.getElementById('selectPredio').addEventListener('change', function () {
                var selectedPredioId = this.value;

                var predioSelecionado = predios.find(function (predio) {
                    return predio.id == selectedPredioId;
                });

                document.getElementById('selectSala').innerHTML = "";
                predioSelecionado.salas.forEach(function (sala) {
                    var salaElement = document.createElement('option');
                    salaElement.value = salaId;
                    salaElement.textContent = sala.nome;

                    document.getElementById('selectSala').appendChild(salaElement);
                });
            });

            //Seleção do menu
            var selecionado = document.getElementById('grade');
            selecionado.classList.add('menu-selecionado');
        </script>

        <script>
            //Atualiza a grade

        </script>

    </body>

</html>
